actions.submitName = function (d, b) {
    if (d.attr("value") == "cancel") {
        $("#mdAddName").trigger("close")
    } else {
        if (!validateFormAddName()) {
            Materialize.toast("Vui lòng kiểm tra lại thông tin nhập!", 2000)
        } else {
            if (d.attr("value") == "delConfirm" && !Cookies.get("wkdth_rmRemindDelName")) {
                $("#mdDelNameConfirm").openModal()
            } else {
                if (d.attr("value") == "del") {
                    if ($("#rmRemind").is(":checked")) {
                        Cookies.set("wkdth_rmRemindDelName", 1, {
                            expires: 90
                        })
                    }
                } else {
                    if (d.attr("value") == "delConfirm") {
                        d.attr("value", "del")
                    }
                }
                $("#btnAddName").prop("disabled", true).removeClass("waves-effect");
                var a = "/name";
                var c = $("#formAddName").serializeArray();
                c.push({
                    name: d.attr("name"),
                    value: d.attr("value")
                });
                $.ajax({
                    type: "POST",
                    url: a,
                    data: c,
                    success: function (f) {
                        if (f.err == ApiError.SUCCESS) {
                            $("#mdAddName").trigger("close");
                            Materialize.toast("Chỉnh sửa tên thành công!", 2000);
                            if (typeof changeNameList !== "undefined") {
                                var e = {};
                                $.each(c, function (g, h) {
                                    e[h.name] = h.value
                                });
                                changeNameList(e)
                            }
                        } else {
                            if (f.err == ApiError.PARAMS_INVALID) {
                                Materialize.toast("Vui lòng kiểm tra lại thông tin nhập!", 2000)
                            } else {
                                if (f.err == ApiError.EXCEED_LIMIT) {
                                    Materialize.toast("Đã vượt số name cho phép. Mời xóa bớt name thừa rồi thử lại.", 2000)
                                } else {
                                    if (f.err == ApiError.SHORT_NAME) {
                                        Materialize.toast("Bạn không thể add name 1 ký tự.", 2000)
                                    } else {
                                        if (f.err == ApiError.FORBID_NAME) {
                                            Materialize.toast("Name này đã bị chặn.", 2000)
                                        } else {
                                            if (f.err == ApiError.BLOCKED) {
                                                Materialize.toast("Truyện đang được lọc lại name, không thể thực hiện thao tác này. Mời bạn thử lại sau.", 2000)
                                            } else {
                                                if (f.err == ApiError.NO_PERMISSION) {
                                                    Materialize.toast("Bạn đã bị khóa chức năng chỉnh sửa name!", 5000)
                                                } else {
                                                    Materialize.toast("Lỗi không xác định. Vui lòng thử lại sau!", 2000)
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        $("#btnAddName").prop("disabled", false).addClass("waves-effect")
                    },
                    error: function (g, e, f) {
                        $("#btnAddName").prop("disabled", false).addClass("waves-effect")
                    }
                })
            }
        }
    }
    b.preventDefault();
    b.stopPropagation()
}
    ;
function validateFormAddName() {
    var b = true;
    var a = {};
    $.each($("#formAddName").serializeArray(), function (c, d) {
        a[d.name] = d.value
    });
    if (!a.nameCn || a.nameCn.length > 20) {
        $("#nameCn").removeClass("valid").addClass("invalid");
        b = false
    } else {
        $("#nameCn").removeClass("invalid").addClass("valid")
    }
    if (!a.nameVi || a.nameVi.length > 120) {
        $("#nameVi").removeClass("valid").addClass("invalid");
        b = false
    } else {
        $("#nameVi").removeClass("invalid").addClass("valid")
    }
    return b
}
function transText(b) {
    if (typeof (b) === "undefined") {
        b = true
    }
    var d = $("#bookId").val();
    var c = $("#nameCn").val();
    var a = $("#nameVi").val();
    $.ajax({
        method: "GET",
        url: "/name/check",
        data: {
            bookId: d,
            nameCn: c,
            nameVi: b ? a : null
        },
        dataType: "json"
    }).done(function (f) {
        if (f.err == ApiError.SUCCESS) {
            $("#nameCv").val(toTitleCase(f.data.name_cv));
            $("#namePy").val(f.data.name_py);
            if (f.data.exists) {
                $("#btnAddName").addClass("hide");
                $("#btnEditName").removeClass("hide");
                $("#btnDelName").removeClass("hide")
            } else {
                $("#nameVi").val(toTitleCase(f.data.name_cv));
                $("#btnAddName").removeClass("hide");
                $("#btnEditName").addClass("hide");
                $("#btnDelName").addClass("hide")
            }
            var e = $("#mdSuggestName");
            e.find(".modal-content").mCustomScrollbar("destroy").html(f.data.suggest_name).mCustomScrollbar();
            $("#mdSuggestName").on("click", "[data-action]", function (g) {
                var h = $(this).data("action");
                if (h in actions) {
                    actions[h]($(this), g)
                }
            });
            $("#btnGoogleTranslate").attr("href", f.data.google_translate);
            $("#btnGoogleSearch").attr("href", f.data.google_search)
        } else {
            if (f.err == ApiError.PARAMS_INVALID) {
                Materialize.toast("Vui lòng kiểm tra lại thông tin nhập!", 2000)
            } else {
                Materialize.toast("Lỗi không xác định. Vui lòng thử lại sau!", 2000)
            }
        }
    })
}
function toTitleCase(a) {
    return a.replace(/\S\S*/g, function (b) {
        return b.charAt(0).toUpperCase() + b.substr(1).toLowerCase()
    })
}
actions.selectSuggestedName = function (b, a) {
    $("#nameVi").val(b.text());
    b.closest(".modal").closeModal()
}
    ;
